<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Admin Paneli - BudgetTracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Modern ve Temiz Tasarƒ±m */
        body { background-color: #f4f6f9; transition: background-color 0.3s, color 0.3s; }
        .navbar { background-color: #212529 !important; } /* Admin rengi koyu olsun */
        .card { border: none; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: background-color 0.3s; }
        
        /* KARANLIK MOD (DARK MODE) */
        body.dark-mode { background-color: #121212; color: #e0e0e0; }
        .dark-mode .card { background-color: #1e1e1e; color: #e0e0e0; }
        .dark-mode .table { color: #e0e0e0; }
        .dark-mode .table-hover tbody tr:hover { background-color: #2c2c2c; }
        .dark-mode .form-control { background-color: #2c2c2c; border-color: #444; color: white; }
        .dark-mode .modal-content { background-color: #1e1e1e; color: white; }
        .dark-mode .btn-close { filter: invert(1); }
    </style>
</head>
<body>

<nav class="navbar navbar-dark px-4 mb-4 shadow">
    <span class="navbar-brand mb-0 h1"><i class="fas fa-user-shield me-2"></i>Admin Paneli</span>
    <div class="d-flex align-items-center">
        <button id="darkModeBtn" class="btn btn-outline-light btn-sm me-3">
            <i class="fas fa-moon"></i>
        </button>
        
        <a href="/" class="btn btn-outline-light btn-sm me-3">
            <i class="fas fa-home me-1"></i> Uygulamaya D√∂n
        </a>
        <span class="text-white me-3">Admin: <span class="fw-bold" th:text="${currentUserName}">Admin</span></span>
        <a href="/logout" class="btn btn-danger btn-sm">√áƒ±kƒ±≈ü</a>
    </div>
</nav>

<div class="container">
    
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card p-4 bg-primary text-white">
                <h4><i class="fas fa-users me-2"></i>Toplam Kullanƒ±cƒ±</h4>
                <h2 th:text="${#lists.size(users)}">0</h2>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card p-4 bg-success text-white">
                <h4><i class="fas fa-tags me-2"></i>Toplam Kategori</h4>
                <h2 th:text="${#lists.size(categories)}">0</h2>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8 mb-4">
            <div class="card p-4">
                <h5 class="mb-3 border-bottom pb-2">üë• Kayƒ±tlƒ± Kullanƒ±cƒ±lar</h5>
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ƒ∞sim</th>
                                <th>Email</th>
                                <th>Rol</th>
                                <th>Durum</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="u : ${users}">
                                <td th:text="${u.id}">1</td>
                                <td th:text="${u.name}" class="fw-bold">ƒ∞sim</td>
                                <td th:text="${u.email}">mail@mail.com</td>
                                <td>
                                    <span class="badge" 
                                          th:classappend="${u.role == 'ROLE_ADMIN' ? 'bg-danger' : 'bg-info'}"
                                          th:text="${u.role}">USER</span>
                                </td>
                                <td><span class="badge bg-success">Aktif</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card p-4">
                <h5 class="mb-3 border-bottom pb-2">üè∑Ô∏è Kategoriler</h5>
                
                <form action="/admin/categories/add" method="post" class="d-flex gap-2 mb-3">
                    <input type="text" name="name" class="form-control" placeholder="Yeni Kategori ƒ∞smi..." required>
                    <button type="submit" class="btn btn-success"><i class="fas fa-plus"></i></button>
                </form>

                <div class="list-group list-group-flush" style="max-height: 400px; overflow-y: auto;">
                    <div th:each="cat : ${categories}" class="list-group-item d-flex justify-content-between align-items-center bg-transparent">
                        <span>
                            <span class="fs-5 me-2" th:text="${cat.icon != null ? cat.icon : 'üìÇ'}">üìÇ</span>
                            <span th:text="${cat.name}" class="fw-bold">Kategori</span>
                        </span>
                        
                        <a th:href="@{/admin/categories/delete/{id}(id=${cat.id})}" 
                           class="btn btn-outline-danger btn-sm"
                           onclick="return confirm('Bu kategoriyi silmek istediƒüine emin misin?')">
                            <i class="fas fa-trash"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Karanlƒ±k Mod Mantƒ±ƒüƒ± (Ana sayfayla aynƒ±)
    const toggleBtn = document.getElementById('darkModeBtn');
    const body = document.body;

    if(localStorage.getItem('darkMode') === 'enabled') enableDarkMode();

    toggleBtn.addEventListener('click', () => {
        if(body.classList.contains('dark-mode')) disableDarkMode();
        else enableDarkMode();
    });

    function enableDarkMode() {
        body.classList.add('dark-mode');
        localStorage.setItem('darkMode', 'enabled');
        toggleBtn.innerHTML = '<i class="fas fa-sun"></i>';
    }

    function disableDarkMode() {
        body.classList.remove('dark-mode');
        localStorage.setItem('darkMode', 'disabled');
        toggleBtn.innerHTML = '<i class="fas fa-moon"></i>';
    }
</script>

</body>
</html>